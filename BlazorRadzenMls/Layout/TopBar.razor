@using System.Timers;
@using BlazorRadzenMls.Models

<RadzenLink Path="">
    <RadzenButton Size="ButtonSize.Large" ButtonStyle="ButtonStyle.Info" Variant="Variant.Text"
                  Icon="home" IconColor="@Colors.Series8" Style="font-weight: 1000; font-size: 1.55rem;" />
</RadzenLink>

<RadzenLink Path="@AppValues.PageOptions">
    <RadzenButton Size="ButtonSize.Large" ButtonStyle="ButtonStyle.Info" Variant="Variant.Text"
                  Icon="build" IconColor="@Colors.Series8" Style="font-weight: 1000; font-size: 1.55rem;" class=@_className />
</RadzenLink>

<RadzenLink Path="">
    <RadzenButton Size="ButtonSize.Large" ButtonStyle="ButtonStyle.Info" Variant="Variant.Text"
                  Icon="account_box" IconColor="@Colors.Series8" Style="font-weight: 1000; font-size: 1.55rem;" />
</RadzenLink>

<RadzenLink Path="@AppValues.GitHubMy" target="_blank" >
    <RadzenButton Size="ButtonSize.Large" ButtonStyle="ButtonStyle.Info" Variant="Variant.Text"
                  Icon="description" IconColor="@Colors.Series8" Style="font-weight: 1000; font-size: 1.55rem;"
                  MouseEnter="@(args => ShowTooltip(args) )" />
</RadzenLink>

@code {

    private string _className = "";

    private void ShowTooltip(ElementReference elementReference)
    {
        var options = new TooltipOptions() { Position = TooltipPosition.Bottom };
        __tooltip.Open(elementReference, "GitHub", options);
    }

    protected override void OnInitialized()
    {
        var versionChecking = new VersionChecking(__http);
        versionChecking.TimerTick += delegate
        {
            if (versionChecking.NeedUpdate)
            {
                if (_className != "rz-background-color-danger-lighter")
                {
                    _className = "rz-background-color-danger-lighter";
                    StateHasChanged();
                    //await InvokeAsync(StateHasChanged);
                }
            }
            else
            {
                if (_className != "")
                {
                    _className = "";
                    StateHasChanged();
                    //await InvokeAsync(StateHasChanged);
                }
            }
        };

        __state.RefreshEvent += delegate { StateHasChanged(); }; //Refresh_Event;
    }
    //private void Refresh_Event(object? sender, EventArgs e) { StateHasChanged(); }

}